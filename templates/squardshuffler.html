<!DOCTYPE html>
<html lang="ko" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Futsal Squad Shuffler | 풋살 팀 나누기</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-98HYEXD6V2"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-98HYEXD6V2');
    </script>
    
    <!-- SEO 기본 메타 -->
    <meta name="description" content="풋살 경기를 위한 팀 나누기 도구. 선수들을 랜덤하게 팀에 배정하고, 드래그 앤드롭으로 자유롭게 이동하세요.">
    <meta name="keywords" content="풋살, 팀 나누기, 스쿼드 셔플러, 팀 구성, 선수 배정, 축구, soccer, futsal, shuffle, squad">
    <meta name="author" content="hughqlee">
    <link rel="canonical" href="https://hughqlee.com/squardshuffler">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:locale" content="ko_KR">
    <meta property="og:title" content="Futsal Squad Shuffler | 풋살 팀 나누기">
    <meta property="og:description" content="풋살 경기를 위한 팀 나누기 도구. 선수들을 랜덤하게 팀에 배정하고, 드래그 앤드롭으로 자유롭게 이동하세요.">
    <meta property="og:url" content="https://hughqlee.com/squardshuffler">
    <meta property="og:site_name" content="Futsal Squad Shuffler">
    <meta property="og:image" content="https://hughqlee.com/static/images/squardshuffler-og.jpg">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Futsal Squad Shuffler | 풋살 팀 나누기">
    <meta name="twitter:description" content="풋살 경기를 위한 팀 나누기 도구. 선수들을 랜덤하게 팀에 배정하고, 드래그 앤드롭으로 자유롭게 이동하세요.">
    <meta name="twitter:image" content="https://hughqlee.com/static/images/squardshuffler-og.jpg">

    <!-- hreflang (다국어 지원) -->
    <link rel="alternate" href="https://hughqlee.com/squardshuffler" hreflang="ko" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=en" hreflang="en" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=ja" hreflang="ja" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=zh" hreflang="zh" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=de" hreflang="de" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=fr" hreflang="fr" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=es" hreflang="es" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=it" hreflang="it" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=pt" hreflang="pt" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=ru" hreflang="ru" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=th" hreflang="th" />
    <link rel="alternate" href="https://hughqlee.com/squardshuffler?lang=vi" hreflang="vi" />

    <!-- 파비콘: 축구공 SVG -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='48' fill='%234CAF50' stroke='white' stroke-width='4'/%3E%3Ccircle cx='50' cy='50' r='30' fill='white' stroke='%234CAF50' stroke-width='4'/%3E%3Cpolygon points='50,30 60,45 50,60 40,45' fill='%234CAF50'/%3E%3C/svg%3E">

    <!-- JSON-LD 구조화 데이터 -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Futsal Squad Shuffler",
      "url": "https://hughqlee.com/squardshuffler",
      "description": "풋살 경기를 위한 팀 나누기 도구. 선수들을 랜덤하게 팀에 배정하고, 드래그 앤드롭으로 자유롭게 이동하세요.",
      "applicationCategory": "SportsApplication",
      "operatingSystem": "All",
      "inLanguage": ["ko", "en", "ja", "zh", "de", "fr", "es", "pt", "ru", "th", "vi"]
    }
    </script>
    <style>
        :root {
            --background: #1e1e2e;
            --foreground: #cdd1e0;
            --card-background: #23243a;
            --card-hover: #2e2e4a;
            --accent: #4CAF50;
            --accent-hover: #45a049;
            --text: #cdd1e0;
            --text-muted: #a0a0a0;
            --border: #3e3e50;
            --icon-bg: #23243a;
            --icon-active: #4CAF50;
        }

        .dark {
            --background: #1e1e2e;
            --foreground: #cdd1e0;
            --card-background: #23243a;
            --card-hover: #2e2e4a;
            --accent: #4CAF50;
            --accent-hover: #45a049;
            --text: #cdd1e0;
            --text-muted: #a0a0a0;
            --border: #3e3e50;
            --icon-bg: #23243a;
            --icon-active: #4CAF50;
        }

        .light {
            --background: #ffffff;
            --foreground: #1e1e2e;
            --card-background: #f5f5f5;
            --card-hover: #e5e5e5;
            --accent: #4CAF50;
            --accent-hover: #45a049;
            --text: #333333;
            --text-muted: #666666;
            --border: #dddddd;
            --icon-bg: #f0f0f0;
            --icon-active: #4CAF50;
        }

        body {
            background: var(--background);
            color: var(--text);
            font-family: 'Pretendard', Arial, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        header {
            text-align: center;
            margin: 40px 0 24px 0;
        }

        .theme-switcher, .language-switcher {
            background: var(--icon-bg);
            border: 2px solid var(--border);
            border-radius: 50%;
            width: 48px; height: 48px;
            display: flex; align-items: center; justify-content: center;
            position: fixed; top: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            transition: background 0.2s, border 0.2s;
            z-index: 10;
            outline: none;
        }

        .theme-switcher { right: 24px; }
        .language-switcher { right: 88px; }
        .theme-switcher:focus, .language-switcher:focus {
            border: 2px solid var(--accent);
            box-shadow: 0 0 0 3px rgba(76,175,80,0.2);
        }
        .theme-switcher:hover, .language-switcher:hover {
            background: var(--accent);
            border: 2px solid var(--accent);
        }
        .theme-switcher svg, .language-switcher svg {
            width: 26px; height: 26px;
            color: #fff;
            background: transparent;
            border-radius: 50%;
            transition: color 0.2s, background 0.2s;
        }
        .theme-switcher:hover svg, .language-switcher:hover svg {
            color: var(--accent);
            background: #fff;
        }
        .language-dropdown {
            position: absolute;
            top: 110%;
            right: 0;
            min-width: 160px;
            background: var(--card-background);
            border: 1.5px solid var(--border);
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.13);
            display: none;
            z-index: 1000;
            padding: 6px 0;
            overflow: hidden;
        }
        .language-dropdown.show { display: block; }
        .language-option {
            padding: 10px 18px;
            cursor: pointer;
            color: var(--text);
            font-size: 1em;
            background: none;
            border: none;
            text-align: left;
            width: 100%;
            transition: background 0.15s, color 0.15s;
            box-sizing: border-box;
            white-space: nowrap;
        }
        .language-option:hover, .language-option.active {
            background: var(--accent);
            color: #fff;
            width: 100%;
        }
        .language-option:focus {
            outline: 2px solid var(--accent);
        }
        .team-container {
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            grid-template-rows: repeat(2, minmax(0, 1fr));
            gap: 24px;
            max-width: 850px;
            min-width: 320px;
            margin: 40px auto 0 auto;
            min-height: 400px;
        }
        .team-card {
            max-width: 400px;
            min-width: 0;
            width: 100%;
            margin: 0 auto;
        }
        @media (max-width: 700px) {
            .team-container {
                grid-template-columns: 1fr 1fr;
                grid-template-rows: 1fr 1fr;
                max-width: 98vw;
                gap: 10px;
            }
            .team-card {
                max-width: 98vw;
                min-width: 0;
                font-size: 0.97em;
            }
        }
        @media (max-width: 480px) {
            .team-container {
                grid-template-columns: 1fr 1fr;
                grid-template-rows: 1fr 1fr;
                gap: 6px;
                min-width: 0;
            }
            .team-card {
                max-width: 100vw;
                min-width: 0;
                font-size: 0.93em;
                padding: 10px 4px 10px 4px;
            }
        }
        .button-container {
            display: flex;
            gap: 12px;
            justify-content: center;
            align-items: center;
            margin: 16px auto 0 auto;
            max-width: 850px;
            padding: 0 20px;
        }
        #shuffle-btn, #kakao-share-btn, #copy-btn {
            display: flex; 
            align-items: center; 
            justify-content: center;
            gap: 8px;
            font-size: 1.1em;
            font-weight: 600;
            border-radius: 8px;
            padding: 14px 32px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
            border: none;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
            min-width: 140px;
            flex: 1;
            max-width: 200px;
        }
        #shuffle-btn {
            background: var(--accent);
            color: #fff;
        }
        #shuffle-btn:hover {
            background: var(--accent-hover);
            transform: translateY(-2px) scale(1.03);
        }
        #shuffle-btn svg {
            width: 22px; height: 22px;
            color: #fff;
        }
        #kakao-share-btn {
            background: #FEE500;
            color: #000000;
        }
        #kakao-share-btn:hover {
            background: #FDD835;
            transform: translateY(-2px) scale(1.03);
        }
        #kakao-share-btn svg {
            width: 22px; height: 22px;
        }
        #copy-btn {
            background: var(--card-background);
            color: var(--text);
            border: 1.5px solid var(--accent);
        }
        #copy-btn:hover {
            background: var(--accent);
            color: #fff;
            transform: translateY(-2px) scale(1.03);
        }
        #copy-btn svg {
            width: 22px; height: 22px;
            color: var(--accent);
            transition: color 0.2s;
        }
        #copy-btn:hover svg {
            color: #fff;
        }
        @media (max-width: 480px) {
            .button-container {
                gap: 8px;
                padding: 0 10px;
            }
            #shuffle-btn, #kakao-share-btn, #copy-btn {
                padding: 12px 16px;
                font-size: 1em;
                min-width: unset;
            }
            #shuffle-btn svg, #kakao-share-btn svg, #copy-btn svg {
                width: 18px;
                height: 18px;
            }
        }
        .team-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 16px;
        }
        .team-title {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--accent);
            letter-spacing: 1px;
        }
        .team-switch {
            display: flex; align-items: center; gap: 8px;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--card-hover);
            transition: .4s;
            border-radius: 20px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        .switch input:checked + .slider { background: var(--accent); }
        .switch input:checked + .slider:before {
            transform: translateX(20px);
        }
        .player-list { flex: 1; }
        .add-player-btn {
            width: 100%;
            background: var(--card-hover);
            color: var(--text);
            border: 1.5px solid var(--accent);
            border-radius: 8px;
            padding: 10px 0;
            margin-top: 12px;
            font-weight: 500;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            transition: background 0.2s, color 0.2s;
        }
        .add-player-btn:hover {
            background: var(--accent);
            color: #fff;
        }
        .add-player-btn svg {
            width: 18px; height: 18px;
            color: var(--accent);
            transition: color 0.2s;
        }
        .add-player-btn:hover svg { color: #fff; }
        .player-card {
            background-color: var(--card-hover);
            margin: 5px 0;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: grab;
            transition: background-color 0.2s ease;
        }
        .player-card .player-name {
            flex-grow: 1;
            margin-left: 8px;
        }
        .player-actions {
            display: flex;
            gap: 5px;
        }
        .player-actions button {
            background: none;
            border: none;
            padding: 5px;
            cursor: pointer;
            color: var(--text-muted);
            font-size: 1.15em;
            border-radius: 4px;
            transition: color 0.18s, background 0.18s;
        }
        .player-actions button.edit:hover {
            color: var(--accent);
            background: rgba(76,175,80,0.08);
        }
        .player-actions button.delete:hover {
            color: #f44336;
            background: rgba(244,67,54,0.10);
        }
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--accent);
            color: white;
            padding: 15px;
            border-radius: 5px;
            display: none;
            z-index: 1000;
        }
        .toast.error {
            background-color: #f44336;
        }
        .grip-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 22px;
            height: 22px;
            margin-right: 4px;
            color: var(--text-muted);
            background: none;
            cursor: grab;
            user-select: none;
            transition: color 0.2s;
        }
        .player-card:hover .grip-icon,
        .grip-icon:focus {
            color: var(--accent);
        }
        .player-card:active .grip-icon {
            color: var(--accent);
        }
        .grip-icon svg {
            width: 18px;
            height: 18px;
            display: block;
        }
        .theme-icon {
            width: 26px;
            height: 26px;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .theme-icon.sun {
            opacity: 0;
            position: absolute;
        }
        .theme-icon.moon {
            opacity: 1;
        }
        .light .theme-icon.sun {
            opacity: 1;
            position: static;
        }
        .light .theme-icon.moon {
            opacity: 0;
            position: absolute;
        }
    </style>
</head>
<body>
    <button class="theme-switcher" id="theme-switcher" aria-label="테마 전환" tabindex="0" role="button">
        <svg class="theme-icon sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg class="theme-icon moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
    </button>

    <div class="language-switcher" id="language-switcher" aria-label="언어 변경" tabindex="0" role="button">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M2 12h20"></path>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
        </svg>
        <div class="language-dropdown" id="language-dropdown">
            <div class="language-option" data-lang="en">English</div>
            <div class="language-option" data-lang="ko">한국어</div>
            <div class="language-option" data-lang="de">Deutsch</div>
            <div class="language-option" data-lang="es">Español</div>
            <div class="language-option" data-lang="fr">Français</div>
            <div class="language-option" data-lang="it">Italiano</div>
            <div class="language-option" data-lang="pt">Português</div>
            <div class="language-option" data-lang="ru">Русский</div>
            <div class="language-option" data-lang="zh">中文</div>
            <div class="language-option" data-lang="ja">日本語</div>
            <div class="language-option" data-lang="th">ไทย</div>
            <div class="language-option" data-lang="vi">Tiếng Việt</div>
        </div>
    </div>

    <header>
        <h1>풋살 스쿼드 셔플러</h1>
        <p>풋살 경기를 쉽게 구성하세요!</p>
        <div class="button-container">
            <button id="shuffle-btn" data-i18n="shuffleButton">랜덤 셔플</button>
        </div>
        <div class="button-container">
            <button id="kakao-share-btn" data-i18n="shareButton">
                <svg viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 3c-4.97 0-9 3.185-9 7.115 0 2.557 1.522 4.82 3.889 6.115-.111.335-.445 1.198-.51 1.39-.165.58-.1.776.385.776.533 0 1.545-.384 2.126-.776.58-.392 1.09-.776 1.09-.776.58 0 1.09.384 1.09.776.58.392 1.593.776 2.126.776.485 0 .55-.196.385-.776-.065-.192-.4-1.055-.51-1.39C19.478 14.935 21 12.672 21 10.115 21 6.185 16.97 3 12 3z"/>
                </svg>
                <span data-i18n="shareButton">명단 공유</span>
            </button>
            <button id="copy-btn" data-i18n="copyButton">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                <span data-i18n="copyButton">복사</span>
            </button>
        </div>
    </header>

    <div class="team-container">
        <div class="team-card active" id="teamA" data-team-id="A">
            <div class="team-header">
                <div class="team-title">팀 A</div>
                <div class="team-switch">
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="player-list"></div>
            <p class="no-player">아직 선수 없음.</p>
            <div class="team-footer">
                <button class="add-player-btn">
                    <span>선수 추가</span>
                </button>
            </div>
        </div>
        <div class="team-card active" id="teamB" data-team-id="B">
            <div class="team-header">
                <div class="team-title">팀 B</div>
                <div class="team-switch">
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="player-list"></div>
            <p class="no-player">아직 선수 없음.</p>
            <div class="team-footer">
                <button class="add-player-btn">
                    <span>선수 추가</span>
                </button>
            </div>
        </div>
        <div class="team-card active" id="teamC" data-team-id="C">
            <div class="team-header">
                <div class="team-title">팀 C</div>
                <div class="team-switch">
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="player-list"></div>
            <p class="no-player">아직 선수 없음.</p>
            <div class="team-footer">
                <button class="add-player-btn">
                    <span>선수 추가</span>
                </button>
            </div>
        </div>
        <div class="team-card active" id="teamD" data-team-id="D">
            <div class="team-header">
                <div class="team-title">팀 D</div>
                <div class="team-switch">
                    <label class="switch">
                        <input type="checkbox" checked>
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
            <div class="player-list"></div>
            <p class="no-player">아직 선수 없음.</p>
            <div class="team-footer">
                <button class="add-player-btn">
                    <span>선수 추가</span>
                </button>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <footer style="text-align: center;">
        <p>Copyright 2025 hughqlee. All rights reserved.</p>
        <ins class="kakao_ad_area" style="display:none;"
        data-ad-unit = "DAN-Dhow2YdUmv7wOZQR"
        data-ad-width = "320"
        data-ad-height = "50"></ins>
        <script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script>
    </footer>

    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', async function () {
            const LOCAL_STORAGE_KEY = "futsalSquadShufflerData";
            const THEME_STORAGE_KEY = "ui-theme";
            const LANGUAGE_STORAGE_KEY = "ui-language";
            
            // 초기 팀 데이터 정의
            const teams = [
                { id: "A", name: "팀 A", players: [], isActive: true },
                { id: "B", name: "팀 B", players: [], isActive: true },
                { id: "C", name: "팀 C", players: [], isActive: true },
                { id: "D", name: "팀 D", players: [], isActive: true }
            ];

            // 번역 데이터 로드
            let translations = {};
            let currentLang = localStorage.getItem(LANGUAGE_STORAGE_KEY) || 'ko';

            async function loadTranslations(lang) {
                try {
                    const response = await fetch(`/static/translations/${lang}.json`);
                    if (!response.ok) throw new Error('Translation file not found');
                    return await response.json();
                } catch (error) {
                    console.error(`Failed to load ${lang} translations:`, error);
                    return null;
                }
            }

            // 번역 함수
            async function t(key, params = {}) {
                if (!translations[currentLang]) {
                    translations[currentLang] = await loadTranslations(currentLang);
                }
                let text = translations[currentLang]?.[key] || translations['ko']?.[key] || key;
                if (params) {
                    Object.keys(params).forEach(param => {
                        text = text.replace(`{${param}}`, params[param]);
                    });
                }
                return text;
            }

            // 언어 전환 함수
            async function changeLanguage(lang) {
                currentLang = lang;
                localStorage.setItem(LANGUAGE_STORAGE_KEY, lang);
                updateLanguageUI();
                await updateContent();
            }

            // 언어 UI 업데이트
            function updateLanguageUI() {
                const dropdown = document.getElementById('language-dropdown');
                dropdown.querySelectorAll('.language-option').forEach(option => {
                    option.classList.toggle('active', option.dataset.lang === currentLang);
                });
            }

            // 콘텐츠 업데이트
            async function updateContent() {
                document.title = await t('title');
                document.querySelector('header h1').textContent = await t('title');
                document.querySelector('header p').textContent = await t('description');
                
                // 셔플 버튼 텍스트 업데이트
                document.getElementById('shuffle-btn').textContent = await t('shuffleButton');
                
                // 카카오톡 공유 버튼 텍스트 업데이트
                const shareButton = document.getElementById('kakao-share-btn');
                shareButton.querySelector('span').textContent = await t('shareButton');
                
                // 복사 버튼 텍스트 업데이트
                const copyButton = document.getElementById('copy-btn');
                copyButton.querySelector('span').textContent = await t('copyButton');
                
                for (const card of document.querySelectorAll('.team-card')) {
                    const index = Array.from(card.parentNode.children).indexOf(card);
                    const teamId = String.fromCharCode(65 + index);
                    card.querySelector('.team-title').textContent = `${await t('teamLabel')} ${teamId}`;
                    card.querySelector('.no-player').textContent = await t('noPlayers');
                    card.querySelector('.add-player-btn span').textContent = await t('addPlayer');
                }
            }

            // 언어 전환 이벤트 리스너
            const languageSwitcher = document.getElementById('language-switcher');
            const languageDropdown = document.getElementById('language-dropdown');

            languageSwitcher.addEventListener('click', (e) => {
                e.stopPropagation();
                languageDropdown.classList.toggle('show');
            });

            document.addEventListener('click', (e) => {
                if (!languageSwitcher.contains(e.target)) {
                    languageDropdown.classList.remove('show');
                }
            });

            languageDropdown.querySelectorAll('.language-option').forEach(option => {
                option.addEventListener('click', () => {
                    const lang = option.dataset.lang;
                    if (lang !== currentLang) {
                        changeLanguage(lang);
                    }
                });
            });

            // 초기 언어 설정
            updateLanguageUI();
            await updateContent();

            // 테마 관리 - 수정된 부분
            function initTheme() {
                const storedTheme = localStorage.getItem(THEME_STORAGE_KEY);
                if (storedTheme === 'light') {
                    document.documentElement.classList.remove('dark');
                    document.documentElement.classList.add('light');
                } else {
                    document.documentElement.classList.add('dark');
                    document.documentElement.classList.remove('light');
                }
            }

            function toggleTheme() {
                const isDark = document.documentElement.classList.contains('dark');
                if (isDark) {
                    document.documentElement.classList.remove('dark');
                    document.documentElement.classList.add('light');
                    localStorage.setItem(THEME_STORAGE_KEY, 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    document.documentElement.classList.remove('light');
                    localStorage.setItem(THEME_STORAGE_KEY, 'dark');
                }
            }

            document.getElementById('theme-switcher').addEventListener('click', toggleTheme);
            document.getElementById('theme-switcher').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    toggleTheme();
                }
            });
            initTheme();

            // 로컬 스토리지에서 불러오기
            function loadFromLocalStorage() {
                const storedData = localStorage.getItem(LOCAL_STORAGE_KEY);
                if (storedData) {
                    const parsedData = JSON.parse(storedData);
                    if (Array.isArray(parsedData)) {
                        // 기존 teams 배열을 비우고 저장된 데이터로 채움
                        teams.length = 0;
                        parsedData.forEach(team => {
                            teams.push(team);
                        });
                        
                        // C와 D 팀이 없으면 추가
                        if (!teams.find(t => t.id === "C")) {
                            teams.push({ id: "C", name: "팀 C", players: [], isActive: true });
                        }
                        if (!teams.find(t => t.id === "D")) {
                            teams.push({ id: "D", name: "팀 D", players: [], isActive: true });
                        }
                        
                        updateUI();
                    }
                }
            }

            // 로컬 스토리지에 저장
            function saveToLocalStorage() {
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(teams));
            }

            // 토스트 메시지 표시
            async function showToast(message, isError = false) {
                const toast = document.getElementById('toast');
                toast.textContent = await t(message);
                toast.className = `toast ${isError ? 'error' : ''}`;
                toast.style.display = 'block';
                setTimeout(() => {
                    toast.style.display = 'none';
                }, 3000);
            }

            // 선수 카드 생성
            function createPlayerCard(player, teamId) {
                const card = document.createElement('div');
                card.className = 'player-card';
                card.draggable = true;
                card.dataset.playerId = player.id;

                card.innerHTML = `
                    <span class="grip-icon" aria-label="드래그로 이동" tabindex="-1">
                        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true">
                            <circle cx="5" cy="5" r="1.1" fill="currentColor"/>
                            <circle cx="5" cy="9" r="1.1" fill="currentColor"/>
                            <circle cx="5" cy="13" r="1.1" fill="currentColor"/>
                            <circle cx="9" cy="5" r="1.1" fill="currentColor"/>
                            <circle cx="9" cy="9" r="1.1" fill="currentColor"/>
                            <circle cx="9" cy="13" r="1.1" fill="currentColor"/>
                        </svg>
                    </span>
                    <span class="player-name">${player.name}</span>
                    <div class="player-actions">
                        <button class="edit" title="수정" aria-label="이름 수정">✎</button>
                        <button class="delete" title="삭제" aria-label="선수 삭제">×</button>
                    </div>
                `;

                card.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('playerId', player.id);
                    e.dataTransfer.setData('sourceTeamId', teamId);
                });

                card.querySelector('.edit').addEventListener('click', () => {
                    const newName = prompt('선수 이름 수정:', player.name);
                    if (newName) {
                        player.name = newName;
                        updateUI();
                        saveToLocalStorage();
                        showToast(`${player.name} 선수의 이름이 수정되었습니다.`);
                    }
                });

                card.querySelector('.delete').addEventListener('click', () => {
                    if (confirm(`${player.name} 선수를 삭제하시겠습니까?`)) {
                        const team = teams.find(t => t.id === teamId);
                        if (team) {
                            team.players = team.players.filter(p => p.id !== player.id);
                            updateUI();
                            saveToLocalStorage();
                            showToast(`${player.name} 선수가 삭제되었습니다.`);
                        }
                    }
                });

                return card;
            }

            // UI 업데이트
            function updateUI() {
                teams.forEach(team => {
                    const teamCard = document.querySelector(`[data-team-id="${team.id}"]`);
                    if (!teamCard) return; // 팀 카드가 없으면 건너뜀
                    
                    const playerList = teamCard.querySelector('.player-list');
                    const noPlayer = teamCard.querySelector('.no-player');
                    const teamSwitch = teamCard.querySelector('input[type="checkbox"]');
                    
                    teamCard.className = `team-card ${team.isActive ? 'active' : 'inactive'}`;
                    teamSwitch.checked = team.isActive;
                    
                    playerList.innerHTML = '';
                    team.players.forEach(player => {
                        playerList.appendChild(createPlayerCard(player, team.id));
                    });
                    
                    noPlayer.style.display = team.players.length === 0 ? 'block' : 'none';
                });
                
                // 디버깅용 출력
                // console.log("현재 팀 상태:", teams);
            }

            // 모든 팀 카드에 이벤트 핸들러 추가
            function setupTeamEventHandlers() {
                document.querySelectorAll('.team-card').forEach(card => {
                    const teamId = card.dataset.teamId;
                    const addPlayerBtn = card.querySelector('.add-player-btn');
                    const teamSwitch = card.querySelector('input[type="checkbox"]');

                    // 기존 이벤트 리스너 제거 (중복 방지)
                    addPlayerBtn.replaceWith(addPlayerBtn.cloneNode(true));
                    const newAddPlayerBtn = card.querySelector('.add-player-btn');
                    
                    // 스위치도 교체
                    teamSwitch.replaceWith(teamSwitch.cloneNode(true));
                    const newTeamSwitch = card.querySelector('input[type="checkbox"]');

                    // 이벤트 리스너 새로 추가
                    newTeamSwitch.addEventListener('change', () => {
                        const team = teams.find(t => t.id === teamId);
                        if (team) {
                            team.isActive = newTeamSwitch.checked;
                            updateUI();
                            saveToLocalStorage();
                            showToast(`${team.name}가 ${team.isActive ? '활성화' : '비활성화'}되었습니다.`);
                        }
                    });

                    newAddPlayerBtn.addEventListener('click', () => {
                        const playerName = prompt('선수 이름을 입력하세요:');
                        if (playerName) {
                            const team = teams.find(t => t.id === teamId);
                            if (team) {
                                team.players.push({
                                    id: crypto.randomUUID(),
                                    name: playerName
                                });
                                updateUI();
                                saveToLocalStorage();
                                showToast(`${playerName} 선수가 ${team.name}에 추가되었습니다.`);
                            }
                        }
                    });

                    // 드래그 앤 드롭 이벤트도 정리
                    const dragOverHandler = (e) => e.preventDefault();
                    card.removeEventListener('dragover', dragOverHandler);
                    card.addEventListener('dragover', dragOverHandler);

                    const dropHandler = (e) => {
                        e.preventDefault();
                        const playerId = e.dataTransfer.getData('playerId');
                        const sourceTeamId = e.dataTransfer.getData('sourceTeamId');
                        
                        if (sourceTeamId === teamId) return;

                        const sourceTeam = teams.find(t => t.id === sourceTeamId);
                        const targetTeam = teams.find(t => t.id === teamId);
                        
                        if (sourceTeam && targetTeam) {
                            const playerIndex = sourceTeam.players.findIndex(p => p.id === playerId);
                            if (playerIndex !== -1) {
                                const player = sourceTeam.players.splice(playerIndex, 1)[0];
                                targetTeam.players.push(player);
                                updateUI();
                                saveToLocalStorage();
                                showToast(`${player.name} 선수가 ${targetTeam.name}으로 이동되었습니다.`);
                            }
                        }
                    };
                    card.removeEventListener('drop', dropHandler);
                    card.addEventListener('drop', dropHandler);
                });
            }

            // 셔플 버튼 이벤트 핸들러 (수정됨)
            document.getElementById('shuffle-btn').addEventListener('click', () => {
                // 1. 활성화된 팀만 필터링
                const activeTeams = teams.filter(team => team.isActive);
                if (activeTeams.length === 0) {
                    showToast('활성화된 팀이 없습니다.', true);
                    return;
                }

                // 2. 모든 팀(활성화/비활성화 모두)에서 선수 가져오기
                let allPlayers = [];
                teams.forEach(team => {
                    // 모든 팀에서 선수를 가져와 배열에 추가
                    allPlayers = allPlayers.concat(team.players);
                    // 각 팀의 선수 배열 비우기
                    team.players = [];
                });

                if (allPlayers.length === 0) {
                    showToast('셔플할 선수가 없습니다.', true);
                    return;
                }

                // 3. 선수들을 셔플
                for (let i = allPlayers.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [allPlayers[i], allPlayers[j]] = [allPlayers[j], allPlayers[i]];
                }

                // 4. 활성화된 팀에만 선수 분배
                allPlayers.forEach((player, index) => {
                    const teamIndex = index % activeTeams.length;
                    activeTeams[teamIndex].players.push(player);
                });

                // 5. UI 업데이트 및 저장
                updateUI();
                saveToLocalStorage();
                showToast('팀이 랜덤하게 재구성되었습니다.');
            });

            // 카카오 SDK 초기화
            Kakao.init('dc41ec699a1414c2ec4d408bcf7d4308'); // 실제 앱 키로 교체 필요

            // 카카오톡 공유 버튼 이벤트 핸들러
            document.getElementById('kakao-share-btn').addEventListener('click', () => {
                // 활성화된 팀만 필터링
                const activeTeams = teams.filter(team => team.isActive);
                if (activeTeams.length === 0) {
                    showToast('활성화된 팀이 없습니다.', true);
                    return;
                }

                // 팀 구성원 텍스트 생성
                let shareText = '';
                activeTeams.forEach(team => {
                    shareText += `${team.name}\n`;
                    if (team.players.length === 0) {
                        shareText += '선수 없음\n';
                    } else {
                        team.players.forEach(player => {
                            shareText += `${player.name}\n`;
                        });
                    }
                    shareText += '\n';
                });

                // 카카오톡 공유
                Kakao.Link.sendDefault({
                    objectType: 'text',
                    text: shareText,
                    link: {
                        mobileWebUrl: window.location.href,
                        webUrl: window.location.href,
                    },
                });
            });

            // 텍스트 복사 버튼 이벤트 핸들러
            document.getElementById('copy-btn').addEventListener('click', () => {
                // 활성화된 팀만 필터링
                const activeTeams = teams.filter(team => team.isActive);
                if (activeTeams.length === 0) {
                    showToast('활성화된 팀이 없습니다.', true);
                    return;
                }

                // 팀 구성원 텍스트 생성
                let copyText = '';
                activeTeams.forEach(team => {
                    copyText += `${team.name}\n`;
                    if (team.players.length === 0) {
                        copyText += '선수 없음\n';
                    } else {
                        team.players.forEach(player => {
                            copyText += `${player.name}\n`;
                        });
                    }
                    copyText += '\n';
                });

                // 클립보드에 복사
                navigator.clipboard.writeText(copyText).then(() => {
                    showToast('팀 명단이 클립보드에 복사되었습니다.');
                }).catch(() => {
                    showToast('복사에 실패했습니다.', true);
                });
            });

            // 초기화 함수들 호출
            loadFromLocalStorage();
            setupTeamEventHandlers();
        });
    </script>
</body>
</html>
